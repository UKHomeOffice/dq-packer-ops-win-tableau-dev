- name: Build Windows server
  hosts: all
  gather_facts: false
  tasks:
    - name: GET config files from S3
      win_shell: aws s3 cp s3://dq-config-bucket/dq-ops-win/ C:\tmp\install\ --recursive
      args:
        executable: powershell.exe
    - win_shell: aws s3 cp s3://dq-config-bucket/dq-tableau/gold-master/TableauDesktop-GoldMaster.exe C:\tmp\install\

    - name: Install Tableau Desktop
      win_shell: C:\tmp\install\TableauDesktop-GoldMaster.exe /quiet /norestart ACCEPTEULA=1
      args:
        executable: powershell.exe

    - name: Copy userdata script
      win_copy:
        src: ./scripts/userdata.ps1
        dest: C:\scripts\
